#!/usr/bin/env bash

function get_git_branch() {
    if [ -d .git ]; then
        # On branches, this will return the branch name
        # On non-branches, (no branch)
        REF="$(git symbolic-ref HEAD 2> /dev/null | sed -e 's/refs\/heads\///')"

        if [[ $REF != "" ]]; then
            echo "$REF"
        else
            echo "(no branch)"
        fi
    fi
}

function color_my_prompt {
    local __newline="\n"
    local __user_and_host="\[\033[01;34m\]\u@\h"
    local __cur_location="\[\033[01;90m\]\w"
    local __git_branch_color="\[\033[31m\]"
    local __git_branch="$(get_git_branch)"
    local __prompt_tail="\[\033[35m\]$"
    local __last_color="\[\033[00m\]"
    export PS1="$__user_and_host $__cur_location $__git_branch_color$__git_branch$__newline$__prompt_tail$__last_color "
}

PROMPT_COMMAND=color_my_prompt
